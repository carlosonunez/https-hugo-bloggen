env:
  matrix:
  - DOCKER_COMPOSE_VERSION=1.22.0
  global:
  - secure: R0R1zwNzP20KTOQGBoWBRfsM1jh63ScgKN6JRbVSHwxdoT04bCVivl+YaqUBP4vexKFbDyMvpxIUQy7H3ebVUkaUG/0JyDOff/FtNDssFPQWs40Zi/xQy2iQIGzSvbnq3b1wUQFajIb8V1D4r8KTLNAlRKPok/TB1HB2H3Jeb9NwPq22lFNRjCM/5vhnL2qPFvTV18KlNVmD89OGKduFD51GmMZOJ6DblI+WNM4A/Y+dk2VHFEJ51pkDMwzckN2FsufACqgiYp1eXuzWXEK9wJ2gFtAXY519w8rXvzEgcuA7DWOeOPrsKoxFth6giTw/qHbvNfPt2PmrPpDlyxIWkv4KjGO3k9JytCGeX8XFEwdpMcF9YNodN2J83kCpBiUog1rof+9sEq1EPFMD1ggoiEGolyHRZ22CBpDUyWZoQtRx+LdoEO3HICzfNKvqcxevGLV6LyJmv4h82M2grFYb4KeJ8Z+zRMPKSlwdU8W+gBxWOUs/waPfR0kPXapedeeU3JOf/qVgcAiUisLBSU65+YHP+5SnizSoYObIkAwOvlCi+AMZF9XUBJQ503L4WSlSDxwBuxQyLwQxT8vO2fvHOKkzxtBcWu7oOndjdMC/vmXQ/zZ51beFyBLOOhz+4RRYYeuknrc2JcvFrxxvXAfQE8VeZaxdZDAA/q3SEBXt3vI=
  - secure: HqUfyRfRVSr2gdRO+Gzgxjk/VZIgL0HjWNxcfCzyLVGYT9Zo3XOwfohwu8oe8KHiaDb27wyYkaGwuuQbrjbFKNCQSj/upQMnVreEHkZc4Fs/baTVj8mOMzTeokrS/zK1gSoaObror0SNrk0w8ZGp7i6YRwEJ24/LTD5mEyYLQs2qxvwslN2JiDgDyevhgikvqy/rtCRqjbaBnrC79VbnhnEF8NpBZxK61nGVxLF7L1VmMVGU50N6oDzEYXinW6JNGun9IPDG87X72M1vLfi9LCAWpKegjqD1YRhI6APtDIrOsVMuph7MCRUNZNI5h2+MFJoqeSYqk3/j1/YC7wJKGrJnsDPglLHAhA5O7eW1brrwgzlHPdngesN3u1tmpSFF/OqTjUuhYDKnT0zHuhuPmnPO6UbxuUI1XuxP6OtZGuzt5CC8/MeCa7bNuT9evxMotdD1RkyE7iPQlJwvVM0FY6N2Eg+QoZbucxl3aT17k8cejCXrquyLPNtNac1um5SI9hOPenLdffxqPaVws2TBQjHo5Zku8e0ziMX8X9PSU4Hlo8zjQAwKiqGIgTgC2cRefQfYsb44rP72oIxIDuz2YS5t2+INrro+JWN8VwxASnFpqqbZxAGXi+hTvzKEwKNsg9/E7lqO1QWq0R47EyPtNIKbghnvaXgKfqhI7nXIOHU=
  - secure: La/zmS/XJSLGJBbTXLhxc7jbu8NbfFRkMBZ7yp5dc36XULzYX0QO2m8x9I8rOhU31prBwThKhgtSZmXUwMTmWTt2Gkh76AL51ZW14JZk/jVGuYrf5fFemzPzrVjDajCckiIesgQJJ0P/jPkS2JmSd0/6CxHN4H+rDYT28HUwOklDoHUvSz8KIX/+0LTP1CkQ2dPNTD3Uj8qx9uX85KLYn+YD+4A5gYJWpa65TrcFG8DhxFlJayx5//LSly38PUut3uj8KhDsp7Im2lf0+dv4GU6ABGHA3vn1Fni+m75j+1tHuQOMAFVNZH3Zg+yW8mc/T0RHIaw9oPl3o0rJ/by4SXRNQ1tInocKbOUZh/oaC/Em1RWuZRMgiKhv8lYNikpJAkP4L5LL/cl9I3N51vxNMk3ECTGoUW5tGOjHietgDVNfvx6gFXxU00n/hEdt8lo4SzIiKSqp5wwzxWw+c6btYj3l9w09GN+Lp2Y8FKg+jZJ5Cf9K4q7Ms9wZDbnKBVHbeMD0+AOn8LufL7C8vFm1wXgXDwOzaXgOKXdQTaQgP8YOQaSpmtzRisf5kDqGj0gsrTX86kuJw586VR53aH9wp81Hg/qeTDVpJr+HxJoauBOdtwuQpOPlcsK1WbCfyGLQ6dinGGBRQ3aN1SDhwZ6mllEFMOK603NeiukwODmWEuc=
  - secure: MaQL5QwunVtsEEuqheGfYrpzxdN/WxBWWkf04fAYce3erzQSF9hG/QeVU7noayZbW/3FLDFG4PSaKIwtILrzzoQGaz0zvopqstIkCSCFIO0LEkfvcOrIep7/p3lRdylqQiGvYwrINUSl8/Juha2Dt+xQwCJGkIYgKwEec6Q9Jz4k4iwP6ja1w4RnObr8Mu0cr7XY+ZOfPOFy3AsQNXXWxPVYKaBxc3RJGYwTKDY7tWC3oBThbTXga9GHAGj8SRq+arQVS98qceeqovXWyQxupfutAj/cHGrRoBGbslu/d6nRkTiEsicLzZSjMeqrlptgXX+vUKaPIk39k3VsR6vngxk1d1bb+m8ubIc9Go0BcTREMHNafNdHFTS62OoV0UqgDEHMf18PYdhvTuNmxSvU/mpIizoL8NUkl/9WLsrSUsOXyKied4HaYiHDtKVAoM3jV3HRUA1fP9Y24MP9E47Kg7NtDiXrb64BHX/QBDOwzKKmdK8OiDsBgggq8eSXHcPw0K7pS4wOKyoqahMR8SNBbPbb+mn4tnkXyIDBhltgEIPFgr2nMrBBs7rJFKhVr/zM+MgfJi6mI2rPKQ6df618gW8swQj/bj/HfIeiAKJyt/A21q6dc8I5l+Ztv0SpuQ0DSvZ2sgUob354OmqqFzsYUcc5Oux1aIMJMh0jfZobZd4=
  - secure: XmxWOX+9IIKIej1eyCNL8NWWcNF9oOicnxFY0xSE86GfNfn4MCCfobesk/DSkxBLbr5f4oAu+5sZF4jFfaTWV4zZX2si9rRqti0KCc8+KKOQ5cYDQ19e4NjbZTQm3VpEMkZENPVyPoDlhNvMsqfIYKI7T00CtGk66JUMffkcl8S6Odaq4/BDFeHUJj5envAkh99RQCo64Ghzuqv3ONdNSPKyjrNwLKnwt4uzRGuZnlYKwxJ6HF3uEWL4WxmfhTDJ82ZKP4y7w20zoO7PZ/MrEIBKrIk1k7dNJQF2EULBNhF/cd1jgz8SRq7N8ko8jnpj44Ac6jkVmOjLqskvCDVGtxQB0Medh84IvvSn/n67ol99tfeRv/FMKNFxA8AIG4UyjEneS22Z852irrpz3x8wzWYqoeHe3+SwpIXnCQlquKfIJXlqXyvbhbwQhZEnjF5pb2beLMOtND6d94njehCe0C3X2O1BQ+qkF49rE8g3+AvuylsWV61aU5XqhNvpc2bNju0OZuMrCzCdLscMSAMTfMikPTSVvT/kQMEXZ3NReA98mbysCdocflSNVbs3FM+nOv/12nwCXq7BUT2b6tE+9QrVm8cU43IyplTtPO+kmOYfA1OyX71gv6Sgof2D9rkrnavyLXVj9Pp/l7K1/i2mRIQ9rfrH+aEdqXGLJMQ+Xfw=
  - secure: MQrdNAMZ11s23Ke3cbjebFL/h1SgUk5sTxBfgCtn0xoUZX3qNk/T0Y2ByTWuZGDdgyRSlrcw2JQilEa8dq8MiF+h6vgeCNu7F7BiFT8SREmub98VqLcABYronkQOqBS6FhgQmGY1DE6fZJw8wCV/pTGf+dMyRo8Ei2lSUhkYsiCqMeAjiaQ3b1VZsPu5ReKRYjV50ttViJJxsK0Tza3rNSQFI58PLTLWgtWK/t69pd/8/xVswBVikx2gQwsuDcieC6pYr/5grkV9Scn8Uq81ZOmgaPs0yvIo9Ln197lqcRKVaReahkyfQ3095TwCw0RZroXXbWM1eKCjTFAEAFeIwxE0R54NzEgq5rTVeFmKN9gTQSEO6aG0oPXTy86OfErQEHtxWeMd+sybZIcAcgGZKb6AdpiLeFiTbW9LAQnP95ktu01UibYQWRD64wY6OYEep37fPOkUAix3E4mG6engaIxZ5SFm9h1MzrhuJTbGTEUcSASlzk3LxtKvmjwqehFqlh3GKI14mzHVzMCyDHuYrtgDBk3TCcyn/YOsQGKmgcnRF2zBtMTtgirAcXpN0Y+SOxvQfR4//kp41XXL5X1Wlcl1AUk5DVIxXTMa3EczY6AJ5gOkODz6hYgNqgJXKHBd5QuOADNgc6fkATS5jJDWwyOb9rs2ULJXTYLRaXXwxlU=
services:
- docker
branches:
  only:
  - master
stages:
- unit
- integration
jobs:
  include:
  - stage: unit
    name: Run Unit Tests
    script:
    -  make create_site_folder_so_travis_works unit
  - stage: integration
    name: Run Integration Tests
    script:
    -  make create_site_folder_so_travis_works integration
before_install:
- openssl aes-256-cbc -K $encrypted_342f2f6ad141_key -iv $encrypted_342f2f6ad141_iv
  -in .env_info.enc -out .env_info -d
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname
  -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
